<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing & Exploited Persons Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .correct {
            background-color: #d1fae5; /* green-100 */
            border-color: #10b981; /* green-500 */
        }
        .incorrect {
            background-color: #fee2e2; /* red-100 */
            border-color: #ef4444; /* red-500 */
        }
        .explanation {
            background-color: #f3f4f6; /* gray-100 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="quiz-container" class="max-w-4xl mx-auto p-4 sm:p-6 lg:p-8">
        <div class="bg-white p-8 rounded-2xl shadow-lg">
            <h1 class="text-3xl font-bold text-center text-gray-900 mb-2">Missing & Exploited Persons Quiz (Final Boss Version)</h1>
            <p class="text-center text-gray-500 mb-8">Practice Version: Review answers as you go.</p>

            <div id="start-screen">
                <p class="text-lg mb-6 text-center">This ultimate final practice quiz now contains 43 questions covering every detail from your handout. After each answer, you'll see a detailed explanation with references. Click "Start Practice" to begin.</p>
                <button id="start-btn" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors duration-300 text-lg">Start Practice</button>
            </div>

            <div id="quiz-screen" class="hidden">
                <div class="flex justify-between items-center mb-4">
                    <div id="question-counter" class="text-sm font-semibold text-gray-600"></div>
                    <div id="score-counter" class="text-sm font-semibold text-gray-600">Score: 0 / 0</div>
                </div>
                <div id="question-card" class="mb-6 p-6 bg-gray-50 rounded-xl border border-gray-200">
                    <h2 id="question-text" class="text-xl font-semibold mb-5"></h2>
                    <div id="options-container" class="space-y-3"></div>
                </div>
                <button id="next-btn" class="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors duration-300 disabled:bg-gray-400" disabled>Next Question</button>
            </div>

            <div id="result-screen" class="hidden text-center">
                <h2 class="text-2xl font-bold mb-4">Practice Complete!</h2>
                <p class="text-5xl font-bold mb-4" id="final-score"></p>
                <p class="text-lg text-gray-600 mb-8" id="score-message"></p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button id="restart-btn" class="w-full sm:w-auto bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors duration-300">Restart Practice</button>
                    <button id="review-btn" class="w-full sm:w-auto bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 transition-colors duration-300">Review All Answers</button>
                </div>
            </div>
        </div>

        <div id="review-section" class="hidden mt-8">
             <h2 class="text-2xl font-bold text-center mb-6">Answer Review</h2>
             <div id="review-container" class="space-y-6"></div>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const startBtn = document.getElementById('start-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const reviewBtn = document.getElementById('review-btn');
        
        const questionCounter = document.getElementById('question-counter');
        const scoreCounter = document.getElementById('score-counter');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        
        const finalScore = document.getElementById('final-score');
        const scoreMessage = document.getElementById('score-message');
        
        const reviewSection = document.getElementById('review-section');
        const reviewContainer = document.getElementById('review-container');

        // --- Quiz Data with References ---
        const quizData = [
            {
                question: "According to CCP 63.001, what is the definition of a 'Child'?",
                options: ["A person under 17 years of age.", "A person under 18 years of age.", "A person under 16 years of age.", "A person who has not graduated high school."],
                answer: "A person under 18 years of age.",
                explanation: "For the purposes of this chapter (Missing Children and Persons), a 'child' is legally defined as a person under 18 years of age.",
                reference: "Handout Page 1: CCP 63.001 (1-a)"
            },
            {
                question: "A 'Missing person' is defined as a person 18 years or older whose disappearance is what?",
                options: ["Confirmed to be voluntary.", "Possibly not voluntary.", "Confirmed to be a criminal act.", "Lasting more than 48 hours."],
                answer: "Possibly not voluntary.",
                explanation: "This definition is broad to allow for an investigation when an adult's disappearance is suspicious or out of character, suggesting it may not have been of their own free will.",
                reference: "Handout Page 1: CCP 63.001 (2)"
            },
            {
                question: "Which circumstance defines a 'Missing child' under CCP 63.001(3)(B)?",
                options: ["The child was taken by a non-custodial parent.", "The child voluntarily left the care of the custodian without consent and without intent to return.", "The child is believed to be in immediate danger.", "The child is hiding from their parents in the house."],
                answer: "The child voluntarily left the care of the custodian without consent and without intent to return.",
                explanation: "This subsection specifically covers the scenario of a runaway child, where the departure is voluntary but without the custodian's permission or intent to come back.",
                reference: "Handout Page 1: CCP 63.001(3)(B)"
            },
            {
                question: "A person of any age who is missing and is under a proven physical or mental disability that subjects them to immediate danger is included in the definition of:",
                options: ["Endangered Person", "At-Risk Adult", "Missing child or missing person", "Voluntary Missing Adult"],
                answer: "Missing child or missing person",
                explanation: "CCP 63.001(4)(A) expands the definition to include vulnerable individuals of any age whose disability places them in danger.",
                reference: "Handout Page 1: CCP 63.001(4)(A)"
            },
            {
                question: "Who is considered the 'Legal custodian of a child' if no managing conservator has been appointed?",
                options: ["The child's teacher", "A grandparent", "The parent of the child", "The Department of Family and Protective Services"],
                answer: "The parent of the child",
                explanation: "The law defaults to the parent as the legal custodian in the absence of a court order appointing a managing conservator or guardian.",
                reference: "Handout Page 2: CCP 63.001(6)"
            },
            {
                question: "The Missing Children and Missing Persons Information Clearinghouse is established within which state agency?",
                options: ["The Texas Rangers", "The Attorney General's Office", "The Department of Public Safety", "The Texas Education Agency"],
                answer: "The Department of Public Safety",
                explanation: "CCP 63.002 establishes the statewide clearinghouse under the administrative direction of the Director of the Department of Public Safety (DPS).",
                reference: "Handout Page 2: CCP 63.002(a)"
            },
            {
                question: "Which of the following is a primary function of the Clearinghouse?",
                options: ["To conduct all missing person investigations.", "To provide a centralized file for the exchange of information on missing persons and unidentified bodies within the state.", "To issue arrest warrants for abductors.", "To provide financial support to families of missing persons."],
                answer: "To provide a centralized file for the exchange of information on missing persons and unidentified bodies within the state.",
                explanation: "The clearinghouse acts as a central repository to collect, process, and disseminate information to aid law enforcement agencies across the state.",
                reference: "Handout Page 3: CCP 63.003(b)(2)"
            },
            {
                question: "Upon receiving a report of a missing child, a law enforcement agency must immediately, but not later than how many hours, enter the child's name into the clearinghouse and NCIC?",
                options: ["1 hour", "2 hours", "12 hours", "24 hours"],
                answer: "2 hours",
                explanation: "CCP 63.00905(a)(2) mandates a rapid response, requiring entry into the state and national databases within two hours of receiving the report.",
                reference: "Handout Page 5: CCP 63.00905(a)(2)"
            },
            {
                question: "Not later than how many days after receiving a report of a missing child must an agency enter the child's name into the National Missing and Unidentified Persons System (NamUs)?",
                options: ["10 days", "30 days", "60 days", "90 days"],
                answer: "30 days",
                explanation: "CCP 63.00905(a)(5) sets a 30-day deadline for entering the case into the NamUs database, which is a national resource for long-term cases.",
                reference: "Handout Page 5: CCP 63.00905(a)(5)"
            },
            {
                question: "If a local law enforcement agency obtains an arrest warrant for a person who took a missing person, the agency must immediately enter the suspect's name into which file?",
                options: ["The local agency's internal file only.", "The National Missing and Unidentified Persons System.", "The national crime information center (NCIC) wanted person file.", "The state's sex offender registry."],
                answer: "The national crime information center (NCIC) wanted person file.",
                explanation: "CCP 63.009(d) requires that the suspect's information be entered into the NCIC wanted person file and cross-referenced with the missing person entry to aid in apprehension.",
                reference: "Handout Page 4: CCP 63.009(d)"
            },
            {
                question: "Immediately after the return of a missing person, what must the local law enforcement agency do?",
                options: ["Issue a press release.", "Clear the entry in the national crime information center (NCIC) database.", "Keep the NCIC entry active for 30 more days.", "Notify the person's employer."],
                answer: "Clear the entry in the national crime information center (NCIC) database.",
                explanation: "CCP 63.009(f) requires the agency to immediately clear the NCIC entry and notify NamUs to ensure law enforcement resources are no longer dedicated to searching for a person who has been found.",
                reference: "Handout Page 5: CCP 63.009(f)"
            },
            {
                question: "If a missing child is designated as 'high risk,' a local law enforcement agency must immediately notify all law enforcement agencies within what radius?",
                options: ["25 miles", "50 miles", "100 miles", "200 miles"],
                answer: "100 miles",
                explanation: "CCP 63.0091(b)(2)(B) requires an escalated response for high-risk cases, which includes notifying all agencies within a 100-mile radius within two hours.",
                reference: "Handout Page 7: CCP 63.0091(b)(2)(B)"
            },
            {
                question: "Which of the following would be a reason to designate a missing child as 'high risk'?",
                options: ["The child has a history of running away.", "The child has mental or behavioral health needs.", "The child disappeared while in a dangerous environment.", "All of the above."],
                answer: "All of the above.",
                explanation: "CCP 63.0091 lists several factors that would qualify a child as high risk, including prior disappearances, being in foster care, having health needs, or disappearing from a dangerous environment.",
                reference: "Handout Page 7: CCP 63.0091(a)"
            },
            {
                question: "What is the waiting period before a law enforcement agency can take a report for a missing child?",
                options: ["24 hours", "48 hours", "72 hours", "There is NO waiting period."],
                answer: "There is NO waiting period.",
                explanation: "It is a common misconception that there is a waiting period. Law enforcement must take a report for a missing child or person immediately.",
                reference: "Handout Page 8: Steps in a missing-child investigation"
            },
            {
                question: "When a report is received for a missing child under 11, law enforcement must immediately notify any school or day care facility the child attended. What must the school or facility do upon receiving this notice?",
                options: ["Close for the day.", "Flag the child's records.", "Send a letter to all parents.", "Delete the child's records."],
                answer: "Flag the child's records.",
                explanation: "CCP 63.020 requires the entity to flag the records so they can immediately notify law enforcement if anyone attempts to access those records (e.g., to enroll the child in a new school).",
                reference: "Handout Page 9: CCP 63.020(c)"
            },
            {
                question: "If a person enrolling a child under 11 in a new school does not provide a birth certificate or other reliable proof of identity within 30 days, what must the school do?",
                options: ["Refuse to enroll the child.", "Notify the appropriate law enforcement agency.", "Call the child's previous school.", "Report the person to Child Protective Services."],
                answer: "Notify the appropriate law enforcement agency.",
                explanation: "CCP 63.019(b) requires the school to notify law enforcement, who will then check the clearinghouse to see if the child has been reported missing.",
                reference: "Handout Page 10: CCP 63.019(b)"
            },
            {
                question: "Clearinghouse records that relate to the investigation of a missing child by a law enforcement agency are considered:",
                options: ["Public record", "Confidential", "Available to the media upon request", "Destroyed after 30 days"],
                answer: "Confidential",
                explanation: "CCP 63.017 protects the integrity of investigations and the privacy of families by making these specific records confidential.",
                reference: "Handout Page 10: CCP 63.017"
            },
            {
                question: "A person with a mental or physical impairment which increases the possibility of putting themselves at risk of immediate harm would be classified as what type of missing person?",
                options: ["Endangered", "Involuntary", "Disability", "Juvenile"],
                answer: "Disability",
                explanation: "This category is for individuals whose disappearance is made more dangerous by a pre-existing condition that might impair their judgment or ability to seek help.",
                reference: "Handout Page 10: 18.1.A. Disability"
            },
            {
                question: "A person of any age who is missing under circumstances that indicate the disappearance was not voluntary is classified as:",
                options: ["Endangered", "Involuntary", "Voluntary missing adult", "Disaster victim"],
                answer: "Involuntary",
                explanation: "This category is used when there is evidence suggesting an abduction or other foul play.",
                reference: "Handout Page 11: 18.1.C. Involuntary"
            },
            {
                question: "A person who is unemancipated and does not meet the criteria for disability, endangered, disaster, or involuntary is classified as what type of missing person?",
                options: ["Runaway", "Throwaway", "Juvenile", "Abducted"],
                answer: "Juvenile",
                explanation: "This is a general category for a missing minor who does not fit into the other, more specific risk categories.",
                reference: "Handout Page 11: 18.1.F. Juvenile"
            },
            {
                question: "When a child is taken by a parent or other family member, depriving another individual of their custody or visitation rights, it is known as a:",
                options: ["Non-family abduction", "Stranger abduction", "Family abduction", "Attempted abduction"],
                answer: "Family abduction",
                explanation: "This is the specific term for an abduction perpetrated by a family member, often in the context of a custody dispute.",
                reference: "Handout Page 12: Family abductions"
            },
            {
                question: "What statewide alert is used to assist in locating an abducted child or a missing person with an intellectual disability?",
                options: ["Silver Alert", "AMBER Alert", "Blue Alert", "CLEAR Alert"],
                answer: "AMBER Alert",
                explanation: "The AMBER Alert is the specific system designed for the most serious cases of child abduction where the child is believed to be in imminent danger.",
                reference: "Handout Page 15: A. Americaâ€™s Missing: Broadcast Emergency Response (AMBER) Alert"
            },
            {
                question: "What is the purpose of a Silver Alert?",
                options: ["To locate an abducted child.", "To warn of severe weather.", "To locate missing senior citizens or persons with Alzheimer's disease.", "To locate a person who is a witness to a crime."],
                answer: "To locate missing senior citizens or persons with Alzheimer's disease.",
                explanation: "The Silver Alert system is specifically for missing older adults with a diagnosed impaired mental condition.",
                reference: "Handout Page 16: B. Silver Alert"
            },
            {
                question: "A CLEAR Alert is a statewide alert used to assist in locating and rescuing what type of person?",
                options: ["Missing children under 13.", "Missing senior citizens.", "Missing, kidnapped, or abducted adults who are in immediate danger of injury or death.", "Missing military members with PTSD."],
                answer: "Missing, kidnapped, or abducted adults who are in immediate danger of injury or death.",
                explanation: "The CLEAR (Coordinated Law Enforcement Adult Rescue) Alert fills the gap for missing adults (ages 18-64) who are not seniors but are in a high-risk situation.",
                reference: "Handout Page 16: E. CLEAR Alert"
            },
            {
                question: "A person commits the offense of False Report Regarding Missing Child or Missing Person (PC 37.081) if, with intent to deceive, they knowingly file a false report. What is the penalty?",
                options: ["Class C Misdemeanor", "Class B Misdemeanor", "Class A Misdemeanor", "State Jail Felony"],
                answer: "Class C Misdemeanor",
                explanation: "Knowingly filing a false report of a missing person is a Class C Misdemeanor.",
                reference: "Handout Page 19: PC 37.081(b)"
            },
            {
                question: "A person commits a Class B Misdemeanor under PC 37.08 if, with intent to deceive, they knowingly make a false statement that is material to a criminal investigation to a peace officer.",
                options: ["True", "False"],
                answer: "True",
                explanation: "This statute is broader than the one for missing persons. Lying to an officer about any material fact during an investigation is a Class B Misdemeanor.",
                reference: "Handout Page 19: PC 37.08"
            },
            {
                question: "When a missing child is recovered, the officer must deliver the child to a person entitled to possession. If that person is not immediately available, where should the officer deliver the child?",
                options: ["To a neighbor's house.", "To the police station.", "To the Department of Family and Protective Services.", "To the local school."],
                answer: "To the Department of Family and Protective Services.",
                explanation: "CCP 63.00905(g) designates DFPS as the appropriate temporary placement for a recovered child when the legal guardian cannot be immediately located.",
                reference: "Handout Page 6: CCP 63.00905(g)"
            },
            {
                question: "Under CCP 63.001, which scenario defines a 'Missing child'?",
                options: ["The child is grounded and hiding in their room.", "The child was taken or retained in violation of the terms of a court order for possession.", "The child is on a planned vacation with one parent.", "The child is late coming home from a friend's house."],
                answer: "The child was taken or retained in violation of the terms of a court order for possession.",
                explanation: "CCP 63.001(3)(C) specifically includes scenarios where a child is taken in violation of a custody or possession order, often related to parental disputes.",
                reference: "Handout Page 1: CCP 63.001(3)(C)"
            },
            {
                question: "What is the definition of a 'Possible match' according to CCP 63.001?",
                options: ["A confirmed DNA link between a body and a missing person.", "When an unidentified body is found in the same city as a missing person.", "Similarities between an unidentified body and a missing person that would lead one to believe they are the same person.", "When a family member tentatively identifies a body."],
                answer: "Similarities between an unidentified body and a missing person that would lead one to believe they are the same person.",
                explanation: "This definition establishes a lower, initial threshold for connecting cases, allowing investigators to explore potential links based on physical descriptions and other similarities before forensic confirmation.",
                reference: "Handout Page 2: CCP 63.001(9)"
            },
            {
                question: "According to CCP 63.0015, for the purposes of a missing child investigation, who is presumed to be the child's parent?",
                options: ["Any adult living in the child's home.", "The person named as the mother or father on the child's birth certificate.", "The person who has filed taxes claiming the child as a dependent.", "The person the child identifies as their parent."],
                answer: "The person named as the mother or father on the child's birth certificate.",
                explanation: "This article creates a legal presumption based on the official birth certificate, simplifying the initial determination of who has parental rights in a missing child case.",
                reference: "Handout Page 2: CCP 63.0015"
            },
            {
                question: "Besides being a central repository, which of these is also a function of the Clearinghouse under CCP 63.003?",
                options: ["To offer rewards for information.", "To provide a statewide toll-free telephone line for reporting and receiving information.", "To conduct undercover operations to find missing children.", "To provide legal counsel to the families of missing persons."],
                answer: "To provide a statewide toll-free telephone line for reporting and receiving information.",
                explanation: "The Clearinghouse is mandated to maintain a toll-free line to make reporting and information sharing accessible to the public and law enforcement across the state.",
                reference: "Handout Page 3: CCP 63.003(b)(5)"
            },
            {
                question: "Under CCP 63.009, if a missing person is reported to have chronic dementia (including Alzheimer's), what is the required law enforcement response?",
                options: ["Start an investigation within 24 hours.", "Wait for a family member to provide a photo.", "Immediately start an investigation to determine their location.", "Enter their name into a local database only."],
                answer: "Immediately start an investigation to determine their location.",
                explanation: "The law requires an immediate investigation for individuals with dementia because their condition puts them at a higher, more immediate risk of harm.",
                reference: "Handout Page 3: CCP 63.009(a)(1)"
            },
            {
                question: "Not later than how many working days after a death is reported must a law enforcement agency enter information about an unidentified body into the clearinghouse and NCIC?",
                options: ["2 working days", "10 working days", "30 working days", "60 working days"],
                answer: "10 working days",
                explanation: "CCP 63.009(c) sets a deadline of 10 working days for entering all available identifying features of an unidentified body into the state and national databases to facilitate a possible match.",
                reference: "Handout Page 4: CCP 63.009(c)"
            },
            {
                question: "For a missing adult (18+), what is the deadline for a law enforcement agency to enter their name into the National Missing and Unidentified Persons System (NamUs)?",
                options: ["Within 2 hours", "Within 48 hours", "Not later than the 30th day", "Not later than the 60th day"],
                answer: "Not later than the 60th day",
                explanation: "Unlike the 30-day requirement for missing children, CCP 63.009(a)(5) allows up to 60 days for entering an adult's information into the long-term NamUs database.",
                reference: "Handout Page 4: CCP 63.009(a)(5)"
            },
            {
                question: "When a request for a flagged record of a missing child is made in person at a school, what must the school employee AVOID doing?",
                options: ["Asking for the person's ID.", "Notifying law enforcement.", "Advising the requesting party that the record is for a missing child.", "Making a copy of the person's driver's license."],
                answer: "Advising the requesting party that the record is for a missing child.",
                explanation: "CCP 63.021(b) explicitly states not to inform the person that the record is flagged. This is a critical step to avoid tipping off a potential abductor and to allow law enforcement time to respond.",
                reference: "Handout Page 8: CCP 63.021(b)"
            },
            {
                question: "If a school requests confirmation that a missing child has been recovered but receives no response from law enforcement, after how many days may the school remove the flag from the child's record?",
                options: ["10 days", "30 days", "45 days", "90 days"],
                answer: "45 days",
                explanation: "CCP 63.022(c) provides a mechanism for schools to un-flag records if they receive no confirmation of recovery after 45 days, ensuring records don't remain flagged indefinitely.",
                reference: "Handout Page 9: CCP 63.022(c)"
            },
            {
                question: "How is an 'Endangered' missing person defined?",
                options: ["Any person who is missing for more than 24 hours.", "A person of any age who is missing and in the company of another person under circumstances that place them in danger.", "An adult who voluntarily leaves but may be suicidal.", "A child who has run away from home for the first time."],
                answer: "A person of any age who is missing and in the company of another person under circumstances that place them in danger.",
                explanation: "This category focuses on the immediate risk posed by the company the missing person is in, which could indicate foul play or a dangerous situation.",
                reference: "Handout Page 11: 18.1.B. Endangered"
            },
            {
                question: "A person of any age who is reported missing and is assumed to be a victim of a disaster, either man-made or natural, is classified as a:",
                options: ["Involuntary Missing Person", "Endangered Person", "Disaster victim", "High-Risk Missing Person"],
                answer: "Disaster victim",
                explanation: "This classification is used for large-scale events like floods, tornadoes, or mass casualty incidents where individuals are unaccounted for as a direct result of the event.",
                reference: "Handout Page 11: 18.1.E. Disaster victim"
            },
            {
                question: "What is the definition of 'Throwaway/giveaway youth'?",
                options: ["Youth who sell their belongings before running away.", "Youth who voluntarily leave a foster care placement.", "Youth who have been asked to leave, forced to leave, or given away by parents or caregivers.", "Youth who are missing as a result of a natural disaster."],
                answer: "Youth who have been asked to leave, forced to leave, or given away by parents or caregivers.",
                explanation: "This term describes youth who are effectively homeless because their caregivers have abandoned them without arranging for alternate care, placing them at an extremely high risk of exploitation.",
                reference: "Handout Page 13: C. Throwaway/giveaway youth"
            },
            {
                question: "An abduction performed by someone who is known, but not related to the victim (such as a neighbor or online acquaintance) is known as a:",
                options: ["Family abduction", "Stranger abduction", "Attempted abduction", "Non-family abduction"],
                answer: "Non-family abduction",
                explanation: "This category covers abductions by acquaintances or strangers, distinguishing them from abductions by parents or other relatives which are classified as family abductions.",
                reference: "Handout Page 12: v. Non-family abductions"
            },
            {
                question: "What is 'goal-directed wandering'?",
                options: ["Wandering with no specific purpose.", "A sudden act of running to escape a stressful situation.", "Wandering with the purpose of getting to something of interest, like water or train tracks.", "Wandering that only occurs at night."],
                answer: "Wandering with the purpose of getting to something of interest, like water or train tracks.",
                explanation: "This type of wandering is characterized by the individual having a specific destination or objective in mind, which can be critical information for search and rescue teams.",
                reference: "Handout Page 13: ii. Types of wandering: 1. Goal-directed wandering"
            },
            {
                question: "What is the purpose of an Endangered Missing Persons Alert?",
                options: ["To locate missing military members.", "To locate missing senior citizens.", "To assist in locating missing persons with an intellectual disability.", "To locate an abducted child."],
                answer: "To assist in locating missing persons with an intellectual disability.",
                explanation: "This specific alert is designed for cases involving missing individuals of any age whose intellectual disability puts them in danger.",
                reference: "Handout Page 16: C. Endangered Missing Persons Alert"
            },
            {
                question: "A Camo Alert is a statewide alert used to assist in locating what type of person?",
                options: ["A person wearing camouflage clothing.", "A missing hunter or outdoorsman.", "A missing current or former member of the United States armed forces.", "A missing person who is a suspect in a crime."],
                answer: "A missing current or former member of the United States armed forces.",
                explanation: "The Camo Alert is specifically for missing service members and veterans, particularly those who may have PTSD or other health issues related to their service.",
                reference: "Handout Page 16: D. Camo Alert"
            }
        ];
        
        // --- State Variables ---
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = [];
        let originalOrder = [];

        // --- Functions ---
        function startQuiz() {
            startScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            reviewSection.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            
            // Store original order for review, then shuffle
            originalOrder = [...quizData];
            quizData.sort(() => Math.random() - 0.5);
            
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = new Array(quizData.length);
            
            showQuestion();
            updateScoreCounter();
        }

        function showQuestion() {
            resetState();
            const currentQuestion = quizData[currentQuestionIndex];
            questionText.innerText = currentQuestion.question;
            questionCounter.innerText = `Question ${currentQuestionIndex + 1} of ${quizData.length}`;
            
            // Create and display options
            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.innerText = option;
                button.classList.add('w-full', 'text-left', 'p-4', 'border', 'rounded-lg', 'transition-colors', 'duration-200', 'hover:bg-indigo-100', 'hover:border-indigo-400');
                button.addEventListener('click', () => selectAnswer(button, option));
                optionsContainer.appendChild(button);
            });
        }

        function resetState() {
            nextBtn.disabled = true;
            nextBtn.innerText = 'Next Question';
            while (optionsContainer.firstChild) {
                optionsContainer.removeChild(optionsContainer.firstChild);
            }
        }

        function selectAnswer(button, selectedOption) {
            const currentQuestion = quizData[currentQuestionIndex];
            const correct = selectedOption === currentQuestion.answer;

            // Find the original index of the current question for storing the answer
            const originalIndex = originalOrder.findIndex(q => q.question === currentQuestion.question);
            userAnswers[originalIndex] = {
                question: currentQuestion.question,
                selected: selectedOption,
                correctAnswer: currentQuestion.answer,
                isCorrect: correct,
                explanation: currentQuestion.explanation,
                reference: currentQuestion.reference
            };

            if (correct) {
                score++;
            }
            updateScoreCounter();
            
            Array.from(optionsContainer.children).forEach(child => {
                child.disabled = true;
                if (child.innerText === currentQuestion.answer) {
                    child.classList.add('correct', 'font-bold');
                } else if (child.innerText === selectedOption) {
                    child.classList.add('incorrect', 'font-bold');
                }
            });

            const explanationEl = document.createElement('div');
            explanationEl.innerHTML = `
                <p class="font-semibold mt-4">Explanation:</p>
                <p>${currentQuestion.explanation}</p>
                <div class="mt-2 pt-2 border-t border-gray-300">
                    <p class="font-semibold">Reference:</p>
                    <p class="text-sm">${currentQuestion.reference}</p>
                </div>
            `;
            explanationEl.classList.add('explanation', 'p-4', 'rounded-lg', 'mt-4');
            optionsContainer.appendChild(explanationEl);

            nextBtn.disabled = false;
            if (currentQuestionIndex === quizData.length - 1) {
                nextBtn.innerText = 'Show Results';
            }
        }

        function handleNextButton() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizData.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            finalScore.innerText = `${score} / ${quizData.length}`;
            
            const percentage = (score / quizData.length) * 100;
            if (percentage >= 80) {
                scoreMessage.innerText = "Excellent work! You have a strong grasp of the material.";
            } else if (percentage >= 60) {
                scoreMessage.innerText = "Good job! A little more review could be beneficial.";
            } else {
                scoreMessage.innerText = "It might be a good idea to review the handout again. Keep trying!";
            }
        }
        
        function updateScoreCounter() {
             scoreCounter.innerText = `Score: ${score} / ${currentQuestionIndex + 1}`;
        }

        function showReview() {
            reviewContainer.innerHTML = ''; 
            
            // Use the userAnswers array which is now indexed correctly
            userAnswers.forEach((answer, index) => {
                if (!answer) return; // Skip if a question was somehow not answered

                const card = document.createElement('div');
                card.classList.add('bg-white', 'p-6', 'rounded-xl', 'shadow-md');
                
                const isCorrect = answer.isCorrect;
                const resultClass = isCorrect ? 'text-green-600' : 'text-red-600';
                const resultText = isCorrect ? 'Correct' : 'Incorrect';

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-lg font-semibold text-gray-800">Question ${index + 1}</h3>
                        <span class="font-bold ${resultClass}">${resultText}</span>
                    </div>
                    <p class="font-medium text-gray-700 mb-4">${answer.question}</p>
                    <div class="space-y-2 text-sm">
                        <p><strong>Your Answer:</strong> <span class="${!isCorrect ? 'text-red-600' : ''}">${answer.selected}</span></p>
                        <p><strong>Correct Answer:</strong> <span class="text-green-700">${answer.correctAnswer}</span></p>
                        <div class="explanation p-3 rounded-md mt-3">
                            <p class="font-semibold">Explanation:</p>
                            <p>${answer.explanation}</p>
                            <div class="mt-2 pt-2 border-t border-gray-300">
                                <p class="font-semibold">Reference:</p>
                                <p class="text-sm">${answer.reference}</p>
                            </div>
                        </div>
                    </div>
                `;
                reviewContainer.appendChild(card);
            });
            reviewSection.classList.remove('hidden');
            reviewSection.scrollIntoView({ behavior: 'smooth' });
        }

        // --- Event Listeners ---
        startBtn.addEventListener('click', startQuiz);
        nextBtn.addEventListener('click', handleNextButton);
        restartBtn.addEventListener('click', startQuiz);
        reviewBtn.addEventListener('click', showReview);

    </script>
</body>
</html>

