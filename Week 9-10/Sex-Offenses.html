<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Study Guide: Sex Offenses</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f3ff; /* Light Purple background */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease;
        }
        details > summary {
            cursor: pointer;
            font-weight: 600;
            padding: 1rem;
            background-color: #ede9fe; /* Lighter Purple */
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        details > summary:hover {
            background-color: #ddd6fe;
        }
        details[open] > summary {
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
        }
        .quiz-option {
            transition: background-color 0.2s;
        }
        .quiz-option.correct {
            background-color: #dcfce7 !important;
            border-color: #22c55e !important;
        }
        .quiz-option.incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background-color: #8b5cf6; /* Purple */
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .offense-card {
            border-left-width: 4px;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .conduct-block {
            background-color: #fafafa;
            border-left: 4px solid #8b5cf6;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }
        .conduct-block p {
            margin-bottom: 0.5rem;
        }
        .conduct-block ul {
            list-style-type: disc;
            padding-left: 1.5rem;
        }
        .offense-misd-c { border-color: #fbbf24; background-color: #fefce8; }
        .offense-misd-a { border-color: #34d399; background-color: #f0fdf4; }
        .offense-sjf { border-color: #fb923c; background-color: #fff7ed; }
        .offense-f3 { border-color: #f87171; background-color: #fef2f2; }
        .offense-f2 { border-color: #ef4444; background-color: #fee2e2; }
        .offense-f1 { border-color: #b91c1c; background-color: #fde2e4; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800">Sex Offenses</h1>
            <p class="text-lg text-gray-600 mt-2">An Interactive Study Guide</p>
        </header>

        <!-- Main Tab Navigation -->
        <div class="mb-8 border-b border-gray-200">
            <nav class="flex flex-wrap -mb-px" id="main-tabs">
                <button class="tab-button active text-lg font-medium py-4 px-6 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" data-tab="tab-adult">Adult Victim Offenses</button>
                <button class="tab-button text-lg font-medium py-4 px-6 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" data-tab="tab-child">Child Victim Offenses</button>
                <button class="tab-button text-lg font-medium py-4 px-6 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" data-tab="tab-pornography">Pornography & Recording</button>
                <button class="tab-button text-lg font-medium py-4 px-6 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" data-tab="tab-prostitution">Prostitution Offenses</button>
                <button class="tab-button text-lg font-medium py-4 px-6 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300" data-tab="tab-quiz">Knowledge Check</button>
            </nav>
        </div>

        <!-- Tab Content -->
        <main id="tab-content">
            <!-- Adult Victim Offenses Tab -->
            <div id="tab-adult" class="tab-pane active">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Adult Victim Offenses</h2>
                <div class="space-y-6">
                    <details class="card p-0">
                        <summary>Sexual Assault (PC 22.011)</summary>
                        <div class="p-6 border-t">
                            <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if a person intentionally or knowingly, without the other person's consent:</p>
                                <ul>
                                    <li>Causes the penetration of the anus or sexual organ of another person by any means;</li>
                                    <li>Causes the penetration of the mouth of another person by the sexual organ of the actor; or</li>
                                    <li>Causes the sexual organ of another person to contact or penetrate the mouth, anus, or sexual organ of another person, including the actor.</li>
                                </ul>
                            </div>
                            <div class="offense-card offense-f2">
                                <h4 class="font-bold text-lg">2nd Degree Felony</h4>
                                <p>This is the base offense level for Sexual Assault.</p>
                            </div>
                             <div class="offense-card offense-f1">
                                <h4 class="font-bold text-lg">1st Degree Felony</h4>
                                <p>The offense is enhanced if the victim was a person the actor was prohibited from marrying or engaging in sexual conduct with under PC 25.01 or 25.02.</p>
                            </div>
                            <a href="https://statutes.capitol.texas.gov/Docs/PE/htm/PE.22.htm#22.011" target="_blank" class="text-blue-600 hover:underline">View Penal Code 22.011</a>
                        </div>
                    </details>
                    <details class="card p-0">
                        <summary>Aggravated Sexual Assault (PC 22.021)</summary>
                        <div class="p-6 border-t">
                             <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if a person commits Sexual Assault AND one of the following aggravating factors is present:</p>
                                <ul>
                                    <li>Causes serious bodily injury or attempts to cause the death of the victim or another.</li>
                                    <li>By acts or words, places the victim in fear of imminent death, SBI, or kidnapping.</li>
                                    <li>Uses or exhibits a deadly weapon.</li>
                                    <li>Administers a substance to impair the victim's ability to resist.</li>
                                    <li>The victim is an elderly or disabled individual.</li>
                                </ul>
                            </div>
                             <div class="offense-card offense-f1">
                                <h4 class="font-bold text-lg">1st Degree Felony</h4>
                                <p>This is the offense level for Aggravated Sexual Assault.</p>
                            </div>
                            <a href="https://statutes.capitol.texas.gov/Docs/PE/htm/PE.22.htm#22.021" target="_blank" class="text-blue-600 hover:underline">View Penal Code 22.021</a>
                        </div>
                    </details>
                    <details class="card p-0">
                        <summary>Indecent Assault (PC 22.012)</summary>
                        <div class="p-6 border-t">
                            <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if a person, without the other person's consent and with the intent to arouse or gratify the sexual desire of any person:</p>
                                <ul>
                                    <li>Touches the anus, breast, or any part of the genitals of another person.</li>
                                    <li>Touches another person with their own anus, breast, or genitals.</li>
                                    <li>Exposes or attempts to expose another's genitals, pubic area, anus, buttocks, or female areola.</li>
                                    <li>Causes another to contact the blood, seminal fluid, vaginal fluid, saliva, urine, or feces of any person.</li>
                                </ul>
                            </div>
                             <div class="offense-card offense-misd-a">
                                <h4 class="font-bold text-lg">Class A Misdemeanor</h4>
                                <p>This is the base offense level for Indecent Assault.</p>
                            </div>
                        </div>
                    </details>
                </div>
            </div>

            <!-- Child Victim Offenses Tab -->
            <div id="tab-child" class="tab-pane hidden">
                 <h2 class="text-3xl font-bold text-gray-800 mb-6">Child Victim Offenses</h2>
                <div class="space-y-6">
                    <details class="card p-0">
                        <summary>Indecency with a Child (PC 21.11)</summary>
                        <div class="p-6 border-t">
                            <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if a person, with a child younger than 17:</p>
                                <ul>
                                    <li>Engages in sexual contact with the child or causes the child to engage in sexual contact.</li>
                                    <li>With intent to arouse or gratify sexual desire, exposes their anus or genitals knowing the child is present, or causes the child to expose their own.</li>
                                </ul>
                            </div>
                            <div class="offense-card offense-f3">
                                <h4 class="font-bold text-lg">3rd Degree Felony</h4>
                                <p>For exposing genitals with sexual intent.</p>
                            </div>
                            <div class="offense-card offense-f2">
                                <h4 class="font-bold text-lg">2nd Degree Felony</h4>
                                <p>For engaging in sexual contact with a child under 17.</p>
                            </div>
                             <a href="https://statutes.capitol.texas.gov/Docs/PE/htm/PE.21.htm#21.11" target="_blank" class="text-blue-600 hover:underline">View Penal Code 21.11</a>
                        </div>
                    </details>
                     <details class="card p-0">
                        <summary>Continuous Sexual Abuse of a Young Child (PC 21.02)</summary>
                        <div class="p-6 border-t">
                             <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if, during a period that is 30 or more days in duration, a person commits two or more acts of sexual abuse against a victim who is a child younger than 14 years of age.</p>
                            </div>
                             <div class="offense-card offense-f1">
                                <h4 class="font-bold text-lg">1st Degree Felony (25 to 99 years or Life)</h4>
                                <p>This is the punishment for Continuous Sexual Abuse of a Young Child.</p>
                            </div>
                             <a href="https://statutes.capitol.texas.gov/Docs/PE/htm/PE.21.htm#21.02" target="_blank" class="text-blue-600 hover:underline">View Penal Code 21.02</a>
                        </div>
                    </details>
                     <details class="card p-0">
                        <summary>Improper Relationship Between Educator and Student (PC 21.12)</summary>
                        <div class="p-6 border-t">
                             <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if a public or private primary or secondary school employee engages in sexual contact, sexual intercourse, or deviate sexual intercourse with a person enrolled in the school where the employee works, or with a student they know is enrolled in any primary or secondary school.</p>
                            </div>
                             <div class="offense-card offense-f2">
                                <h4 class="font-bold text-lg">2nd Degree Felony</h4>
                                <p>This is the offense level for an Improper Relationship Between an Educator and Student.</p>
                            </div>
                             <a href="https://statutes.capitol.texas.gov/Docs/PE/htm/PE.21.htm#21.12" target="_blank" class="text-blue-600 hover:underline">View Penal Code 21.12</a>
                        </div>
                    </details>
                </div>
            </div>

            <!-- Pornography & Recording Tab -->
            <div id="tab-pornography" class="tab-pane hidden">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Pornography & Unlawful Recording</h2>
                <div class="space-y-6">
                    <details class="card p-0">
                        <summary>Invasive Visual Recording (PC 21.15)</summary>
                        <div class="p-6 border-t">
                             <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if, without consent and with intent to invade privacy, a person:</p>
                                <ul>
                                    <li>Photographs or records a visual image of an intimate area of another person who has a reasonable expectation of privacy.</li>
                                    <li>Photographs or records a visual image of another in a bathroom or changing room.</li>
                                    <li>Promotes a recording known to have been made in violation of this statute.</li>
                                </ul>
                            </div>
                             <div class="offense-card offense-sjf">
                                <h4 class="font-bold text-lg">State Jail Felony</h4>
                                <p>This is the offense level for Invasive Visual Recording.</p>
                            </div>
                             <a href="https://statutes.capitol.texas.gov/Docs/PE/htm/PE.21.htm#21.15" target="_blank" class="text-blue-600 hover:underline">View Penal Code 21.15</a>
                        </div>
                    </details>
                    <details class="card p-0">
                        <summary>Possession or Promotion of Child Pornography (PC 43.26)</summary>
                        <div class="p-6 border-t">
                            <div class="conduct-block">
                                <p><strong>Conduct:</strong> An offense if a person knowingly or intentionally possesses, or accesses with intent to view, visual material that visually depicts a child younger than 18 engaging in sexual conduct, and the person knows the material depicts the child in such a manner.</p>
                            </div>
                             <div class="offense-card offense-f3">
                                <h4 class="font-bold text-lg">3rd Degree Felony</h4>
                                <p>The base offense for possessing fewer than 100 depictions.</p>
                            </div>
                             <div class="offense-card offense-f2">
                                <h4 class="font-bold text-lg">2nd Degree Felony</h4>
                                <p>The offense is enhanced for possessing 100 to 499 depictions. Promoting child pornography is also a 2nd Degree Felony.</p>
                            </div>
                             <div class="offense-card offense-f1">
                                <h4 class="font-bold text-lg">1st Degree Felony</h4>
                                <p>The offense is enhanced for possessing 500 or more depictions.</p>
                            </div>
                             <a href="https://statutes.capitol.texas.gov/Docs/PE/htm/PE.43.htm#43.26" target="_blank" class="text-blue-600 hover:underline">View Penal Code 43.26</a>
                        </div>
                    </details>
                </div>
            </div>
            
            <!-- Prostitution Offenses Tab -->
            <div id="tab-prostitution" class="tab-pane hidden">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Prostitution & Related Offenses</h2>
                 <div class="space-y-6">
                    <details class="card p-0">
                        <summary>Prostitution & Solicitation</summary>
                        <div class="p-6 border-t">
                            <div class="conduct-block">
                                <p><strong>Prostitution (PC 43.02):</strong> An offense if a person knowingly offers or agrees to receive a fee from another to engage in sexual conduct.</p>
                                <p><strong>Solicitation of Prostitution (PC 43.021):</strong> An offense if a person knowingly offers or agrees to pay a fee to another person for the purpose of engaging in sexual conduct.</p>
                            </div>
                            <p><strong>Prostitution:</strong> A <strong class="font-semibold">Class B Misdemeanor</strong>, enhanced to a State Jail Felony after 3 or more convictions.</p>
                            <p class="mt-4"><strong>Solicitation of Prostitution:</strong> A <strong class="font-semibold">State Jail Felony</strong>, enhanced to a 2nd Degree Felony if the person solicited is under 18.</p>
                        </div>
                    </details>
                    <details class="card p-0">
                        <summary>Promotion & Compelling Prostitution</summary>
                        <div class="p-6 border-t">
                            <div class="conduct-block">
                                <p><strong>Promotion of Prostitution (PC 43.03):</strong> An offense if a person, acting other than as a prostitute, knowingly receives money from or solicits another for prostitution.</p>
                                <p><strong>Aggravated Promotion of Prostitution (PC 43.04):</strong> An offense if a person knowingly owns, invests in, finances, controls, supervises, or manages a prostitution enterprise that uses two or more prostitutes.</p>
                                <p><strong>Compelling Prostitution (PC 43.05):</strong> An offense if a person knowingly causes another by force, threat, or fraud to commit prostitution, or causes a child under 18 to commit prostitution.</p>
                            </div>
                            <p><strong>Promotion of Prostitution:</strong> A <strong class="font-semibold">3rd Degree Felony</strong>.</p>
                            <p class="mt-4"><strong>Aggravated Promotion of Prostitution:</strong> A <strong class="font-semibold">1st Degree Felony</strong>.</p>
                            <p class="mt-4"><strong>Compelling Prostitution:</strong> A <strong class="font-semibold">1st Degree Felony</strong>.</p>
                        </div>
                    </details>
                 </div>
            </div>

            <!-- Quiz Tab -->
            <div id="tab-quiz" class="tab-pane hidden">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Knowledge Check Quiz</h2>
                <div id="quiz-container" class="space-y-8">
                    <!-- Quiz questions will be injected here by JS -->
                </div>
                <div id="quiz-results" class="mt-8 text-center hidden">
                    <h3 class="text-2xl font-bold">Quiz Complete!</h3>
                    <p id="quiz-score" class="text-4xl font-bold my-4"></p>
                    <button id="retake-quiz" class="bg-purple-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-purple-700">Retake Quiz</button>
                </div>
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // Tab functionality
    const tabs = document.querySelectorAll('.tab-button');
    const tabPanes = document.querySelectorAll('.tab-pane');

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');

            tabPanes.forEach(pane => {
                pane.classList.add('hidden');
                if (pane.id === tab.dataset.tab) {
                    pane.classList.remove('hidden');
                }
            });
        });
    });

    // Quiz Functionality
    const quizData = [
        {
            question: "A person commits Sexual Assault. During the assault, they exhibit a knife. What is the most serious offense committed?",
            options: ["Sexual Assault (2nd Degree Felony)", "Assault with a Deadly Weapon (2nd Degree Felony)", "Aggravated Sexual Assault (1st Degree Felony)", "Robbery (2nd Degree Felony)"],
            answer: "Aggravated Sexual Assault (1st Degree Felony)",
            explanation: "<strong>Reference: PC 22.021(a)(2)(A)(iv).</strong> Committing a sexual assault while using or exhibiting a deadly weapon elevates the offense to Aggravated Sexual Assault, a 1st Degree Felony."
        },
        {
            question: "An adult engages in sexual intercourse with their 18-year-old first cousin. What offense has been committed?",
            options: ["Sexual Assault (2nd Degree Felony)", "Prohibited Sexual Conduct (3rd Degree Felony)", "Incest (2nd Degree Felony)", "No offense"],
            answer: "Prohibited Sexual Conduct (3rd Degree Felony)",
            explanation: "<strong>Reference: PC 25.02(a)(6).</strong> The statute prohibits sexual intercourse between first cousins. This offense is a 3rd Degree Felony."
        },
        {
            question: "A high school teacher has a consensual sexual relationship with a 17-year-old student who attends the same school. What is the offense?",
            options: ["Sexual Assault (2nd Degree Felony)", "No offense, it was consensual", "Indecency with a Child (2nd Degree Felony)", "Improper Relationship Between Educator and Student (2nd Degree Felony)"],
            answer: "Improper Relationship Between Educator and Student (2nd Degree Felony)",
            explanation: "<strong>Reference: PC 21.12.</strong> This statute specifically makes it a 2nd Degree Felony for a school employee to engage in sexual intercourse with a student enrolled at the school where they work, regardless of consent."
        },
        {
            question: "A person possesses 250 images of child pornography on their computer. What is the offense level?",
            options: ["State Jail Felony", "3rd Degree Felony", "2nd Degree Felony", "1st Degree Felony"],
            answer: "2nd Degree Felony",
            explanation: "<strong>Reference: PC 43.26(d).</strong> Possessing 100 or more but fewer than 500 visual depictions of child pornography is a 2nd Degree Felony."
        },
        {
            question: "A person knowingly offers to pay a fee to another adult for sexual conduct. What is the offense?",
            options: ["Prostitution (Class B Misdemeanor)", "Compelling Prostitution (1st Degree Felony)", "Solicitation of Prostitution (State Jail Felony)", "No offense"],
            answer: "Solicitation of Prostitution (State Jail Felony)",
            explanation: "<strong>Reference: PC 43.021.</strong> Knowingly offering to pay a fee for sexual conduct is Solicitation of Prostitution, a State Jail Felony."
        },
        {
            question: "What is the base offense level for Indecent Assault?",
            options: ["Class C Misdemeanor", "Class B Misdemeanor", "Class A Misdemeanor", "State Jail Felony"],
            answer: "Class A Misdemeanor",
            explanation: "<strong>Reference: PC 22.012(b).</strong> Indecent Assault is a Class A Misdemeanor, with enhancements for prior convictions or if the actor is a healthcare provider."
        },
        {
            question: "A person, with intent to arouse, exposes their genitals to a 15-year-old child. What is the offense?",
            options: ["Disorderly Conduct (Class C)", "Indecent Exposure (Class B)", "Indecency with a Child (3rd Degree Felony)", "Sexual Assault (2nd Degree Felony)"],
            answer: "Indecency with a Child (3rd Degree Felony)",
            explanation: "<strong>Reference: PC 21.11(a)(2).</strong> Exposing genitals to a child under 17 with sexual intent is Indecency with a Child, a 3rd Degree Felony."
        },
        {
            question: "A person who knowingly owns, finances, and manages a prostitution enterprise that uses three prostitutes commits what offense?",
            options: ["Promotion of Prostitution (3rd Degree Felony)", "Aggravated Promotion of Prostitution (1st Degree Felony)", "Compelling Prostitution (1st Degree Felony)", "Online Promotion of Prostitution (3rd Degree Felony)"],
            answer: "Aggravated Promotion of Prostitution (1st Degree Felony)",
            explanation: "<strong>Reference: PC 43.04.</strong> Knowingly managing a prostitution enterprise that uses two or more prostitutes is Aggravated Promotion of Prostitution, a 1st Degree Felony."
        },
        {
            question: "A person uses their phone to secretly record a visual image of another person's intimate area in a public place where they had a reasonable expectation of privacy. What is the offense?",
            options: ["Harassment (Class B)", "Disorderly Conduct (Class C)", "Invasive Visual Recording (State Jail Felony)", "Online Impersonation (3rd Degree Felony)"],
            answer: "Invasive Visual Recording (State Jail Felony)",
            explanation: "<strong>Reference: PC 21.15.</strong> This statute makes it a State Jail Felony to record a person's intimate area without consent when they have a reasonable expectation of privacy."
        },
        {
            question: "A person commits two acts of sexual assault against a 12-year-old child over a period of two months. What is the most serious offense?",
            options: ["Two counts of Aggravated Sexual Assault (1st Degree Felony)", "Continuous Sexual Abuse of a Young Child (1st Degree Felony, 25-Life)", "Indecency with a Child (2nd Degree Felony)", "Sexual Performance by a Child (2nd Degree Felony)"],
            answer: "Continuous Sexual Abuse of a Young Child (1st Degree Felony, 25-Life)",
            explanation: "<strong>Reference: PC 21.02.</strong> Committing two or more acts of sexual abuse against a child under 14 during a period of 30 days or more is Continuous Sexual Abuse, which carries a minimum sentence of 25 years."
        }
    ];

    const quizContainer = document.getElementById('quiz-container');
    const quizResultsContainer = document.getElementById('quiz-results');
    const quizScoreEl = document.getElementById('quiz-score');
    const retakeBtn = document.getElementById('retake-quiz');

    function buildQuiz() {
        quizContainer.innerHTML = '';
        quizResultsContainer.classList.add('hidden');
        quizContainer.classList.remove('hidden');
        
        quizData.forEach((currentQuestion, questionNumber) => {
            const options = currentQuestion.options.map(option =>
                `<div class="quiz-option border-2 border-gray-300 rounded-lg p-4 hover:bg-gray-100 cursor-pointer" data-question="${questionNumber}">${option}</div>`
            ).join('');

            const questionEl = document.createElement('div');
            questionEl.classList.add('card', 'p-6');
            questionEl.innerHTML = `
                <p class="text-lg font-semibold mb-4">Question ${questionNumber + 1}: ${currentQuestion.question}</p>
                <div class="space-y-3" id="options-${questionNumber}">${options}</div>
                <div class="explanation-container mt-4"></div>
            `;
            quizContainer.appendChild(questionEl);
        });

        const options = document.querySelectorAll('.quiz-option');
        options.forEach(option => {
            option.addEventListener('click', selectAnswer);
        });
    }

    let score = 0;
    let answeredQuestions = 0;

    function selectAnswer(e) {
        const selectedOption = e.target;
        const questionNumber = selectedOption.dataset.question;
        const currentQuestion = quizData[questionNumber];
        const correctAnswer = currentQuestion.answer;

        const optionContainer = document.getElementById(`options-${questionNumber}`);
        optionContainer.querySelectorAll('.quiz-option').forEach(opt => {
            opt.removeEventListener('click', selectAnswer);
            opt.style.cursor = 'default';
        });

        if (selectedOption.textContent === correctAnswer) {
            selectedOption.classList.add('correct');
            score++;
        } else {
            selectedOption.classList.add('incorrect');
            optionContainer.querySelectorAll('.quiz-option').forEach(opt => {
                if(opt.textContent === correctAnswer) {
                    opt.classList.add('correct');
                }
            });
        }
        
        // Show explanation
        const explanationContainer = optionContainer.parentElement.querySelector('.explanation-container');
        const explanationEl = document.createElement('div');
        explanationEl.className = 'p-3 mt-4 bg-gray-100 border border-gray-300 rounded-lg text-sm text-gray-700';
        explanationEl.innerHTML = currentQuestion.explanation;
        explanationContainer.appendChild(explanationEl);

        answeredQuestions++;
        if (answeredQuestions === quizData.length) {
            showResults();
        }
    }
    
    function showResults() {
        setTimeout(() => {
            quizContainer.classList.add('hidden');
            quizResultsContainer.classList.remove('hidden');
            quizScoreEl.textContent = `${score} / ${quizData.length}`;
            const percentage = (score / quizData.length) * 100;
            if(percentage >= 80) {
                quizScoreEl.style.color = '#16a34a';
            } else if (percentage >= 50) {
                quizScoreEl.style.color = '#f59e0b';
            } else {
                quizScoreEl.style.color = '#dc2626';
            }
        }, 1500);
    }
    
    retakeBtn.addEventListener('click', () => {
        score = 0;
        answeredQuestions = 0;
        buildQuiz();
    });

    buildQuiz();
});
</script>

</body>
</html>
